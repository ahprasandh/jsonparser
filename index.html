<!DOCTYPE html>
<html>

<head>
  <title>Json Parser</title>
  <link rel="icon" type="image/png" href="data:image/png;base64,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" id="favicon">
  <style type="text/css">
    html,
    body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      background: #272C32;
      font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
    }

    .parent {
      overflow: hidden;
      /*border: 1px solid #ccc;*/
      border-radius: 6px;
      padding: 10px;
      height: calc(100% - 40px);
      width: calc(100% - 40px);
      margin: 10px;
    }

    * {
      margin: 0;
      padding: 0;
    }

    .inputwrapper,
    .outputwrapper {
      height: 100%;
      width: 40%;
      float: left;
    }

    .outputwrapper {
      width: 60%;
      font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
      font-size: 12px;
    }

    .editor {
      height: calc(100% - 40px);
      width: calc(100% - 30px);
      margin: 0 10px;
      resize: none;
      border: none;
      border-radius: 0 0 5px 5px;
      padding: 5px;
      box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.12);
      background: #2c343b;
      font-size: 13px;
      color: #cacaca;
    }

    .outputArea {
      margin: 0 10px;
      border-radius: 0 0 5px 5px;
      height: calc(100% - 50px);
      overflow: scroll;
      padding: 10px;
      overflow-wrap: break-word;
      box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.12);
      color: #cacaca;
    }

    .editor:focus {
      outline: none;
      background: #2c343b;
    }

    .parserList {
      list-style-type: none;
      margin: 0;
      padding: 0 0 0 20px;
    }

    .parserList li {
      display: flex;
    }

    .string {
      color: #d88859;
      overflow: hidden;
    }

    .number {
      color: #178e2c;
    }

    .boolean {
      color: #c4a000;
    }

    .null {
      color: #babdb6;
      font-style: italic;
    }

    .key {
      position: relative;
      color: #86bbdc;
    }

    .brace {
      cursor: pointer;
    }

    .curly {
      color: #729FCF;
    }

    .array {
      color: #A40000;
    }

    .openBrace::before {
      content: '-';
    }

    .array::before {
      border-color: #a40000;
      color: #a40000;
    }

    .icon::before {
      border-radius: 2px;
      border-style: solid;
      border-width: .1em;
      display: inline-block;
      line-height: 7px;
      margin: 0 2px;
      overflow: hidden;
      border-color: #729fcf;
      color: #729fcf;
      padding-top: 1px;
    }

    .collapsed::before {
      content: '+';
      padding-top: 2px;
    }

    .jsonOB,
    .arrayOB {
      margin-left: 5px;
    }

    .jsonOB:hover,
    .arrayOB:hover {
      margin-left: 4px;
      border-left: 1px dotted #fff;
      border-radius: 5px;
    }

    .error .outputTop {
      background: #FF8A80;
      color: #fff;
    }

    .error .outputArea {
      background: #FFEBEE;
    }

    .errorColumn {
      background: #F44336;
    }

    .encode {
      font-size: 12px;
      cursor: pointer;
      color: #fff;
      border-radius: 4px;
      margin: 5px 0 0 10px;
      padding: 5px;
      display: inline-block;
      background: #333;
      float: right;
    }

    .decode {
      color: #000;
      background: #cacaca;
    }

    .inputTop,
    .outputTop {
      padding: 0 20px;
      background: #1d2227;
      margin: 0 10px;
      width: calc(100% - 59px);
      border-radius: 5px 5px 0 0;
      height: 35px;
      box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.12);
      overflow: hidden;
      color: #ccc;
    }

    .outputTop {
      background: #1d2227;
    }

    .title {
      font-size: 15px;
      font-weight: 600;
      padding-top: 9px;
      float: left;
      width: 50%;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    }

    .titleInput {
      margin: 5px 10px;
      resize: none;
      border: none;
      border-radius: 0 0 5px 5px;
      padding: 5px;
      box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.12);
      background: #2c343b;
      font-size: 13px;
      color: #cacaca;
    }

    .titleInput:focus-visible {
      outline: none
    }

    .userselect {
      user-select: all;
      cursor: pointer;
    }

    .nouserselect {
      user-select: none;
    }

    .keyToolTip {
      display: none;
      position: absolute;
      background: #1c2227;
      width: fit-content;
      text-align: center;
      margin-top: -20px;
      padding: 2px;
      border-radius: 3px;
      color: #cacaca;
      z-index: 9999;
      cursor: pointer;
      width: 100px;
    }

    .key:hover .keyToolTip {
      display: block;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script type="text/javascript">
    var jsonParserComponent = {
      props: ["json", "last", "lastkey"],
      data: function () {
        return {
          collapse: true
        }
      },
      template:
        `   <span v-if="json === null" class="null">null<span class="nouserselect" v-if="!last">,</span></span>
            <span v-else-if="typeof json === 'string'" class="string userselect"><span class="nouserselect">"</span>{{json}}<span class="nouserselect">"</span><span class="nouserselect" v-if="!last">,</span></span>
            <span v-else-if="typeof json === 'number' || typeof json === 'boolean'" class="userselect" :class="{'number':typeof json === 'number','boolean':typeof json === 'boolean'}">{{json}}<span class="nouserselect" v-if="!last">,</span></span>
            <div v-else-if="json instanceof Array"  class="arrayOB">
                <span :class="{'collapsed':!collapse}" class="array brace openBrace"  @click="collapse=!collapse">[</span>
                    <ul v-if="collapse">
                        <li  v-for="value,i in json">
                            <jsonparser :json="value" :last="i==json.length-1" :lastkey="lastkey+'['+i+']'"></jsonparser>
                        </li>
                    </ul>
                    <span class="count" v-else v-text="json.length" @click="collapse=!collapse"/>
                <span class="array brace">]<span class="nouserselect" v-if="!last">,</span></span>
            </div>
            <div v-else class="jsonOB" >
                <span :class="{'collapsed':!collapse}" class="curly brace openBrace" @click="collapse=!collapse">{</span>
                <ul v-if="collapse" class="parserList">
                    <li v-for="value,key,i in json" >
                        <span class="key">"{{key}}"<span class="keyToolTip">{{lastkey+'.'}}<span class="userselect">{{key}}</span></span></span> :

                        <jsonparser :json="value" :last="i===Object.keys(json).length-1" :lastkey="lastkey+'.'+key"></jsonparser>
                    </li>
                </ul>
                <span class="count" v-else>...</span>
                <span class="curly brace" @click="collapse=!collapse">}<span class="nouserselect" v-if="!last">,</span></span>
            </div>`,
      methods: {
        parseJSON: function (json) {
          var parser = { value: json };
          if (json === null) {
            parser.type = "null";
          } else if (typeof json === 'number') {
            parser.type = "number";
          } else if (typeof json === 'boolean') {
            parser.type = "boolean"
          } else if (typeof json === 'string') {
            parser.type = "string"
          } else if (json instanceof Array) {
            parser.type = "array"
            parser.value = []
            for (i in json) {
              parser.value.push(this.parseJSON(json[i]))
            }
          } else {
            var keyarray = Object.keys(json)
            var lastKey = keyarray[keyarray.length - 1];
            parser.type = "object"
            parser.value = {}
            for (key in json) {
              parser.value[key] = this.parseJSON(json[key]);
            }
          }
          return parser;
        }
      }
    }
    var App = {
      template:
        `<div class="parent">
          <div class="inputwrapper">
            <div class="inputTop">
              <input class='titleInput' v-if="titleInput" v-focus @keyup.enter="titleInput=false;setTitle()" v-model="title"/>
              <span v-else class="title" @click='titleInput=true'>Json Parser, UTF-8 Encoder &amp; Decoder</span>
              <span class="encode" @click="encode()">Encode</span>
              <span class="encode decode" @click="decode()">Decode</span>
              <span class="encode format" @click="beautify()">Beautify</span>
            </div>
            <textarea  class="editor" id="editor" spellcheck="false" v-model="input" contenteditable="true"></textarea>
          </div>
          <div class="outputwrapper" id="outputwrapper">
            <div class="outputTop">
              <span id="outputTitle" class="title" v-text="mode">Json Parser, UTF-8 Encoder &amp; Decoder</span>
              <span class="encode" @click="copy()">Copy</span>
            </div>
            <div v-if="json && mode==='Json Parser'" id="outputArea" class="outputArea">
              <jsonparser  :json="json" last="true" lastkey="json"></jsonparser>
            </div>
            <div v-else id="outputArea" class="outputArea">
              {{output.partial}}
              <span v-if="error" class="errorColumn">{{output.error}} </span>
            </div>
          </div>
        </div>`,
      name: "JSON-Parser",
      directives: {
        focus: {
          inserted: function (el) {
            el.focus()
          }
        }
      },
      data: function () {
        return {
          titleInput: false,
          title: "",
          input: '{"ID":null,"name":"Doe","first-name":"John","age":25,"hobbies":["reading","cinema",{"sports":["volley-ball","badminton"]}],"address":{}}',
          output: {
            partial: '',
            error: ''
          },
          json: null,
          error: false,
          mode: null
        }
      },
      mounted: function () {
        this.parseJSON()
      },
      methods: {
        parseJSON() {
          var text = this.input;
          if (text != null && text !== '') {
            try {
              text = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
              text = JSON.parse(text);
              this.json = text
              this.mode = 'Json Parser';
            } catch (err) {

              this.json = null
              this.mode = 'error';
              this.error = true;
              if (err instanceof SyntaxError) {
                var lineNumber = err.message.split('position ')[1];
                if (lineNumber) {
                  lineNumber = parseInt(lineNumber)
                  this.output.partial = text.slice(0, lineNumber)
                  this.output.error = text.slice(lineNumber, text.length);
                } else if (err.message === "Unexpected end of JSON input") {
                  this.output.error = err.message;
                }
              }

            }
          }
        },
        encode: function () {
          this.json = null
          this.mode = 'Encoder';
          this.error = false;
          this.output.partial = encodeURIComponent(this.input)
        },
        decode: function () {
          this.json = null
          this.mode = 'Decoder';
          this.error = false;
          this.output.partial = decodeURIComponent(this.input)
        },
        beautify: function () {
          this.input = JSON.stringify(JSON.parse(this.input), null, "\t");
        },
        setTitle() {
          document.title = this.title
        },
        copy: function () {
          var text = '';
          if (this.mode === 'Encoder' || this.mode === 'Decoder') {
            text = this.output.partial
          } else if (!this.error) {
            text = JSON.stringify(this.json)
          }
          if (!navigator.clipboard) {
            var textArea = document.createElement("textarea");
            textArea.value = text;

            // Avoid scrolling to bottom
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
              document.execCommand('copy');
              this.message("Copied")
            } catch (err) {
              this.message("Not Copied")
            }

            document.body.removeChild(textArea);
            return;
          }
          var message = this.message
          navigator.clipboard.writeText(text).then(function () {
            message("Copied")
          }, function (err) {
            message("Not Copied")
          });
        },
        message(m) {
          alert(m)
        }
      },
      watch: {
        'input': function () {
          this.parseJSON()
        }
      }
    };


  </script>
</head>

<body>
  <div id="app"></div>
  <script type="text/javascript">
    Vue.config.devtools = true;
    Vue.component('jsonparser', jsonParserComponent);
    var app = new Vue({
      el: "#app",
      render: function (data) { return data(App); }
    });
  </script>
</body>

</html>
